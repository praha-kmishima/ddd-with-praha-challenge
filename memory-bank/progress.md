# 進捗状況

## 完了した機能

### 基本的なTODOリスト機能 ✅
- タスクエンティティ、リポジトリ、ユースケース、APIエンドポイントの実装

### 開発環境の整備 ✅
- TypeScript、Vitest、Biome、Docker Compose、Drizzleの設定

### 値オブジェクトの実装 ✅
- Result型、EmailAddress、EnrollmentStatus、TeamName、ProgressStatusの実装

### チーム集約の実装 ✅
- TeamMemberエンティティ、Teamエンティティ、TeamRepositoryの実装

### 課題集約の拡張 ✅
- Taskエンティティの拡張（所有者と進捗ステータスの追加）
- タスクリポジトリの拡張（所有者による検索機能の追加）

## 進行中の機能

### ドメインイベント基盤の実装（フェーズ1）
- ❌ ドメインイベントの基底クラス
- ❌ イベントバスの実装
- ❌ 単体テスト

## 次に実装予定の機能

### ドメインイベント基盤の実装（フェーズ別）
- ❌ フェーズ1: ドメインイベント基盤の基本実装
  - ドメインイベントの基底クラス
  - イベントバスの実装
  - 単体テスト
- ❌ フェーズ2: チーム集約の基本イベント実装
  - チーム作成イベント
  - メンバー追加イベント
  - Team集約へのイベント発行機能追加
- ❌ フェーズ3: 課題集約のイベント実装
  - 課題進捗更新イベント
  - Task集約へのイベント発行機能追加
- ❌ フェーズ4: 追加のチームイベント実装
  - メンバー削除イベント
  - メンバー状態変更イベント
  - Team集約への追加イベント発行機能追加
- ❌ フェーズ5: チームサイズ関連イベント実装
  - チーム過小サイズイベント
  - チーム過大サイズイベント
  - Team集約へのサイズ関連イベント発行機能追加
- ❌ フェーズ6: 基本的なイベントハンドラー実装
  - イベントハンドラーの基本実装
  - 単体テスト

### アプリケーション層のポリシーとドメインサービスの実装
- ❌ TeamReorganizationService（チーム統合・分割アルゴリズム）
- ❌ TeamReorganizationPolicy
- ❌ TaskManagementPolicy

### ユースケースの実装
- ❌ チーム関連のユースケース
- ❌ 課題関連のユースケース

### APIエンドポイントの実装
- ❌ チーム関連のAPIエンドポイント
- ❌ 課題関連のAPIエンドポイント

## 既知の問題

### 設計上の問題
1. **Value Objectの実装**
   - 基本的な値オブジェクトの実装パターンが確立

2. **Nominal Typingの未対応**
   - 同じプロパティを持つクラスが型的に等価になってしまう
   - ドメインの概念を型で明確に区別できていない

3. **集約間の参照方法**
   - 集約間の参照をIDで行う方針は実装済み
   - 整合性確保の仕組みが未実装

### 技術的な問題
1. **エラーハンドリング**
   - Result型を用いたエラーハンドリングの基盤は整備
   - 統一的なエラーハンドリングの仕組みが不足

2. **テストカバレッジ**
   - ドメイン層とリポジトリ層のテスト実装は完了
   - ユースケースやアプリケーション層のテストが不足

3. **パフォーマンス**
   - N+1問題への対応が不十分
   - クエリの最適化が必要

4. **既存ユースケースの更新**
   - タスク完了状態変更ユースケースは進捗ステータス更新ユースケースに置き換える必要がある

## 実装計画（スモールステップ）

### マイルストーン1: 値オブジェクトの実装 ✅
- EmailAddress、EnrollmentStatus、TeamName、ProgressStatus値オブジェクトの実装

### マイルストーン2: チーム集約の実装 ✅
- TeamMemberエンティティ、Teamエンティティ、チームリポジトリの実装

### マイルストーン3: 課題集約の拡張 ✅
- Taskエンティティの拡張、タスクリポジトリの拡張

### マイルストーン4: ドメインイベント基盤の実装
1. **フェーズ1: ドメインイベント基盤の基本実装**
   - ドメインイベントの基底クラス
   - イベントバスの実装
   - 単体テスト
2. **フェーズ2: チーム集約の基本イベント実装**
   - チーム作成イベント
   - メンバー追加イベント
   - Team集約へのイベント発行機能追加
3. **フェーズ3: 課題集約のイベント実装**
   - 課題進捗更新イベント
   - Task集約へのイベント発行機能追加
4. **フェーズ4: 追加のチームイベント実装**
   - メンバー削除イベント
   - メンバー状態変更イベント
   - Team集約への追加イベント発行機能追加
5. **フェーズ5: チームサイズ関連イベント実装**
   - チーム過小サイズイベント
   - チーム過大サイズイベント
   - Team集約へのサイズ関連イベント発行機能追加
6. **フェーズ6: 基本的なイベントハンドラー実装**
   - イベントハンドラーの基本実装
   - 単体テスト

### マイルストーン5: ドメインサービスの実装
- TeamReorganizationServiceの実装（チーム統合・分割アルゴリズム）

### マイルストーン6: アプリケーション層のポリシー実装
- TeamReorganizationPolicy、TaskManagementPolicyの実装

### マイルストーン7: ユースケースの実装
- チーム関連のユースケース、課題関連のユースケースの実装

### マイルストーン8: APIエンドポイントの実装
- チーム関連のAPIエンドポイント、課題関連のAPIエンドポイントの実装

### マイルストーン9: クエリ最適化とパフォーマンス改善
- クエリサービスの実装、パフォーマンス測定と改善
