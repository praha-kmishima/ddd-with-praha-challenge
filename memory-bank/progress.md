# 進捗状況

## 完了した機能

### 基本的なTODOリスト機能
- ✅ タスクエンティティの実装
  - タイトルと完了状態を持つシンプルな構造
  - タイトルのバリデーション（空文字チェック、最大長チェック）
  - ULIDによるID生成

- ✅ タスクリポジトリの実装
  - インターフェース定義
  - PostgreSQL実装

- ✅ タスク関連のユースケース
  - タスク作成ユースケース
  - タスクタイトル編集ユースケース
  - タスク完了状態変更ユースケース

- ✅ タスク関連のAPIエンドポイント
  - タスク作成エンドポイント（POST /tasks/new）
  - タスク取得エンドポイント（GET /tasks/:id）
  - タスクリスト取得エンドポイント（GET /tasks）
  - タスクタイトル編集エンドポイント（PATCH /tasks/:id/title）
  - タスク完了状態変更エンドポイント（PATCH /tasks/:id/done）

### 開発環境の整備
- ✅ TypeScriptの設定
- ✅ Vitestによるテスト環境
- ✅ Biomeによるリント/フォーマット
- ✅ Docker Composeによるデータベース環境
- ✅ Drizzleによるマイグレーション管理

## 進行中の機能

### ドメインモデルの設計
- 🔄 集約の再設計
  - チーム集約（参加者を子エンティティとして含む）
  - 課題集約

- 🔄 値オブジェクトの設計
  - EmailAddress
  - EnrollmentStatus
  - ProgressStatus

### アーキテクチャの整備
- 🔄 ドメインイベントの仕組み検討
- 🔄 アプリケーション層のポリシー設計
- 🔄 最小限のドメインサービス設計

## 未実装の機能

### チーム管理
- ❌ チームエンティティ（集約ルート）
- ❌ TeamMemberエンティティ（子エンティティ）
- ❌ チームリポジトリ
- ❌ チーム関連のユースケース
  - チーム作成
  - チーム情報編集
  - メンバー追加
  - メンバー削除
  - メンバー状態変更

### 課題管理
- ❌ 課題エンティティ（現在のタスクの拡張）
- ❌ 課題リポジトリ
- ❌ 課題関連のユースケース
  - 課題割り当て
  - 進捗ステータス更新

### ドメインイベント基盤
- ❌ イベント発行の仕組み
- ❌ イベントハンドラーの実装
- ❌ イベント購読の仕組み

### アプリケーション層のポリシー
- ❌ TeamReorganizationPolicy
- ❌ TaskManagementPolicy

### ドメインサービス
- ❌ チーム再編サービス（複雑なアルゴリズムのみ）

### 複雑なビジネスルール
- ❌ 参加者の増減に伴うチーム再編ロジック
- ❌ メール通知機能
- ❌ 課題の進捗管理ロジック

## 既知の問題

### 設計上の問題
1. **Value Objectの未実装**
   - 現状はプリミティブ型を直接使用している
   - 値オブジェクトによるドメインの表現力が不足

2. **Nominal Typingの未対応**
   - 同じプロパティを持つクラスが型的に等価になってしまう
   - ドメインの概念を型で明確に区別できていない

3. **集約間の参照方法**
   - 集約間の参照をIDで行う方針だが、実装が不十分
   - 整合性確保の仕組みが未実装

### 技術的な問題
1. **エラーハンドリング**
   - 一部のユースケースでのみカスタムエラーを定義
   - 統一的なエラーハンドリングの仕組みが不足

2. **テストカバレッジ**
   - ドメイン層のみテスト実装
   - ユースケースやインフラストラクチャ層のテストが不足

3. **パフォーマンス**
   - N+1問題への対応が不十分
   - クエリの最適化が必要

## 次のマイルストーン

### マイルストーン1: チーム集約の実装
- チームエンティティ（集約ルート）の実装
- TeamMemberエンティティ（子エンティティ）の実装
- EmailAddressとEnrollmentStatus値オブジェクトの実装
- チームリポジトリの実装
- チーム関連のユースケースとAPIエンドポイントの実装
- チームのテストケース実装

### マイルストーン2: ドメインイベント基盤の実装
- ドメインイベントの基底クラス実装
- イベント発行の仕組み実装
- イベントハンドラーの実装
- イベント購読の仕組み実装
- イベント永続化の検討

### マイルストーン3: 課題集約の拡張
- 課題エンティティとProgressStatus値オブジェクトの実装
- 課題リポジトリの実装
- 課題関連のユースケースとAPIエンドポイントの実装
- 課題のテストケース実装

### マイルストーン4: アプリケーション層のポリシーとドメインサービスの実装
- TeamReorganizationPolicyの実装
- TaskManagementPolicyの実装
- チーム再編サービス（複雑なアルゴリズムのみ）の実装
- 複雑なビジネスルールのテストケース実装

### マイルストーン5: クエリ最適化とパフォーマンス改善
- 読み取り操作のためのクエリサービスの実装
- N+1問題の解決
- パフォーマンス測定と改善
